<div>

  <div class="slds-page-header" style="padding: 0.3rem;">
    <div class="slds-page-header__row">
      <div class="slds-page-header__col-title">
        <div class="slds-media">
          <div *ngIf="session.recipientPhotoUrl" class="slds-media__figure">
            <span class="slds-icon_container">
              <img src="{{session.recipientPhotoUrl}}" alt="Profile picture" class="image-round">
            </span>
          </div>
          <div [hidden]="session.recipientPhotoUrl" #recipientAbbrevDiv class="slds-media__figure slds-p-around_medium">
              {{recipientAbbrev}}
          </div>
          <div class="slds-media__body slds-m-top_xx-small">
            <div>
              Your session with
            </div>
            <div class="slds-text-heading_small slds-truncate">
              <span>{{session.recipientName}}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div style="overflow: scroll;" #chatDiv>
    <section role="log" class="slds-chat">

      <div *ngIf="!loaded" class="slds-align_absolute-center" style="height: 7rem;">
        <div role="status" class="slds-spinner slds-spinner_medium slds-spinner_inline">
          <span class="slds-assistive-text">Loading</span>
          <div class="slds-spinner__dot-a"></div>
          <div class="slds-spinner__dot-b"></div>
        </div>
      </div>

      <div *ngIf="loaded" class="slds-align_absolute-center">
        <a *ngIf="!noMoreToLoad" class="slds-button" (click)="loadMoreMessages()">Load more</a>
        <span *ngIf="noMoreToLoad">No previous messages found</span>
      </div>

      <ul class="slds-chat-list">

        <li *ngIf="showSessionEmptyMsg" class="slds-chat-listitem">
          <div class="slds-chat-bookend" style="border:0px">
            <span class="slds-icon_container slds-icon-utility-chat slds-chat-icon">
              <svg class="slds-icon slds-icon_x-small slds-icon-text-default" aria-hidden="true">
                <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#chat"></use>
              </svg>
            </span>
            <p>This is the start of your first session with
              <b>{{session.recipientName}}</b>. Please type a message below to begin.</p>
          </div>
        </li>

        <li *ngFor="let message of sessionMessages" [ngClass]="{'slds-chat-listitem':true, 'slds-chat-listitem_inbound':!message.mine, 'slds-chat-listitem_outbound':message.mine}">
          <div class="slds-chat-message">
            <div class="slds-chat-message__body">
              <div [ngClass]="{'slds-chat-message__text':true, 'slds-chat-message__text_inbound':!message.mine, 'slds-chat-message__text_outbound':message.mine}">
                <span>{{message.text}}</span>
              </div>
              <div [ngSwitch]="message.mine">
                <div class="slds-chat-message__meta">
                  <span *ngSwitchCase="true">You • {{convertToLocalDate(message.createDate) | timeAgo}}</span>
                  <span *ngSwitchCase="false">{{message.senderName}} •
                    {{convertToLocalDate(message.createDate) | timeAgo}}</span>
                </div>
              </div>
            </div>
          </div>
        </li>

      </ul>
    </section>
  </div>

  <div>
    <div class="slds-form-element">
      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_left-right">
        <svg class="slds-icon slds-input__icon slds-input__icon_left slds-icon-text-default" aria-hidden="true">
          <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#chat" />
        </svg>
        <textarea #messageInput rows="1" (keyup)="autoGrowMessageInput()" placeholder="Type your message here..."
          [(ngModel)]="messageText" class="slds-input"></textarea>
        <button *ngIf="messageText.length > 0" (click)="createMessage()" class="slds-button slds-input__icon slds-input__icon_right"
          title="Send">
          <svg class="slds-button__icon" aria-hidden="true">
            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#send" />
          </svg>
          <span class="slds-assistive-text">Send</span>
        </button>
      </div>
    </div>
  </div>

</div>